# åä¸‡æ•°æ®å¯¼å‡º

<input :id="$style.input1" placeholder="æˆ‘æ˜¯è¾“å…¥æ¡† -- å¯¼å‡ºæ•°æ®ä¸ä¼šé€ æˆä¸»çº¿ç¨‹é˜»å¡" />
<button :id="$style.btn1" @click="exportData">ğŸš€ç‚¹å‡»å°è¯•å¯¼å‡ºåä¸‡æ•°æ®</button>

<script setup>
// å¼•å…¥xlsx
import "https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/xlsx/0.18.2/xlsx.js"
import { ref } from "vue"

const worker = new Worker("/programmer/worker/exportTensOfThousandsData.js")

// è§¦å‘å¯¼å‡º
const exportData = () => {
    // å‘é€æ¶ˆæ¯
    worker.postMessage("")
}

// æ¥æ”¶æ•°æ®
worker.onmessage = (e) => {
    // è·å–å·¥ä½œç°¿
    const wb = e.data
    // å¯¼å‡º
    XLSX.writeFile(wb, "data.xlsx")
}
</script>

<style module>
#input1 {
    margin: 20px 0;
    width: 100%;
    border: 1px solid #4d4d4d;
    padding: 4px;
}

#btn1{
    border: 1px solid #4d4d4d;
    padding: 4px;
}
</style>

## ä½¿ç”¨ worker å®ç°
```vue
<!-- main.vue -->

<template>
    <button @click="exportData">å¯¼å‡ºæ•°æ®</button>
</template>

<script setup>
import XLSX from "xlsx"

// åˆ›å»ºworker
const worker = new Worker("worker .js")

// è§¦å‘å¯¼å‡º
const exportData = () => {
    // å‘é€æ¶ˆæ¯
    worker.postMessage("")
}
// æ¥æ”¶æ•°æ®
worker.onmessage = (e) => {
    // è·å–å·¥ä½œç°¿
    const wb = e.data
    // å¯¼å‡º
    XLSX.writeFile(wb, "data.xlsx")
}
</script>
```

```js
// worker.js
importScripts("https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/xlsx/0.18.2/xlsx.js")

// ç”Ÿæˆæ•°æ®
const arr = []
// ç”Ÿæˆ10ä¸‡æ¡æ•°æ®
for (let i = 0; i < 100000; i++) {
    arr.push({
        id: i,
        name: "å¼ ä¸‰" + i,
        age: i,
        a: i++,
        b: i--,
        c: i/2,
    })
}
// æ¥æ”¶æ•°æ®
self.onmessage = (e) => {
    // ç”Ÿæˆå·¥ä½œç°¿
    const wb = XLSX.utils.book_new()
    // ç”Ÿæˆå·¥ä½œè¡¨
    const ws = XLSX.utils.json_to_sheet(arr)
    // æ·»åŠ å·¥ä½œè¡¨
    XLSX.utils.book_append_sheet(wb, ws, "Sheet1")
    // å‘é€æ•°æ®
    self.postMessage(wb)
}
```